{"version":3,"sources":["colourclusters.js"],"names":[],"mappings":"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","file":"colourclusters-compiled.js","sourcesContent":["/**\n * Created by josh on 11/07/2016.\n */\ndocument.addEventListener(\"DOMContentLoaded\", init, false);\n\nvar swatchCanvas;\nvar swatchCanvasCtx;\n\nfunction init(){\n    document.getElementById(\"url-input\").addEventListener(\"keydown\", function(evt){\n        if(evt.keyCode == 13){\n            extractDominateColour(document.getElementById(\"url-input\").value);\n        }\n    });\n\n    swatchCanvas = document.getElementById(\"swatch_canvas\");\n    swatchCanvasCtx = swatchCanvas.getContext(\"2d\");\n}\n\nfunction extractDominateColour(url) {\n    var swatches = document.getElementById(\"swatches\");\n    // while (swatches.firstChild) {\n    //     swatches.removeChild(swatches.firstChild);\n    // }\n    swatchCanvasCtx.clearRect(0, 0, swatchCanvasCtx.width, swatchCanvasCtx.height);\n\n    document.getElementById(\"dominant-swatch\").style.background = \"rgb(255, 255, 255)\";\n\n    document.getElementById(\"target-image\").src = url;\n\n    var clusters = getQueryStringParameterByName(\"clusters\");\n    if(clusters == null || clusters.length == 0){\n        clusters = \"6\";\n    }\n\n    var mode = getQueryStringParameterByName(\"mode\");\n    if(mode == null || mode.length == 0){\n        mode = \"kmeans\";\n    }\n\n    var colourSpace = getQueryStringParameterByName(\"colourspace\");\n    if(colourSpace == null || colourSpace.length == 0){\n        colourSpace = \"rgb\";\n    }\n\n    var packet = \"image_url=\" + url;\n    packet += \"&clusters=\" + clusters;\n    packet += \"&colourspace=\" + colourSpace.toLowerCase();\n    packet += \"&mode=\" + mode.toLowerCase();\n\n    var serviceURL = \"https://instacolour.herokuapp.com/api/colourclusters\";\n\n    var xhr = new XMLHttpRequest();\n    xhr.onload = function(e) {\n        console.log(xhr.response);\n        if(xhr.response != null){\n            var jsonObj = JSON.parse(xhr.response)\n            if(jsonObj.hasOwnProperty(\"colour_clusters\")){\n                var colourClusters = jsonObj[\"colour_clusters\"];\n\n                if(colourClusters != null && colourClusters.length > 0){\n                    colourClusters.sort(function(a,b){\n                        if(a[\"percentage\"] > b[\"percentage\"]){\n                            return -1;\n                            \n                        }\n                        else if(a[\"percentage\"] < b[\"percentage\"]){\n                            return 1;\n                        }\n                        return 0;\n                    });\n\n                    document.getElementById(\"dominant-swatch\").style.background = getColourFromJSONObject(colourClusters[0]);\n\n                    for(var i=0; i<colourClusters.length; i++) {\n                        var colourCluster = colourClusters[i];\n                        if(colourCluster.hasOwnProperty(\"swatch\")){\n                            if(colourCluster[\"swatch\"] == \"vibrant_swatch\"){\n                                document.getElementById(\"dominant-swatch\").style.background = getColourFromJSONObject(colourCluster);\n                                break;\n                            }\n                        }\n\n                    }\n\n\n                    // var swatchContainer = document.getElementById(\"swatches\");\n                    // for(var i=0; i<colourClusters.length; i++){\n                    //     var div = document.createElement(\"div\");\n                    //     div.className = \"swatch\";\n                    //     div.style.background = getColourFromJSONObject(colourClusters[i]);\n                    //     swatchContainer.appendChild(div);\n                    // }\n\n                    var ox = 0;\n\n                    var totalPercentage = 0.0;\n                    for(var i=0; i<colourClusters.length; i++){\n                        var colourCluster = colourClusters[i];\n                        totalPercentage += colourCluster[\"percentage\"];\n                    }\n\n                    for(var i=0; i<colourClusters.length; i++){\n                        var colourCluster = colourClusters[i];\n                        var percentage = colourCluster[\"percentage\"] / totalPercentage;\n                        var width = parseInt(swatchCanvas.width * percentage);\n                        swatchCanvasCtx.fillStyle = getColourFromJSONObject(colourCluster);\n                        swatchCanvasCtx.fillRect(ox, 0, width, swatchCanvas.height);\n                        ox += width;\n                    }\n                }\n            }\n        }\n    }\n\n    xhr.open(\"POST\", serviceURL, true);\n    xhr.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\n    xhr.send(packet);\n}\n\nfunction getColourFromJSONObject(obj){\n    return \"rgb(\" + obj[\"colour\"][0] + \", \" + obj[\"colour\"][1] + \", \" + obj[\"colour\"][2] + \")\";\n}\n\nfunction getQueryStringParameterByName(name, url) {\n    if (!url) url = window.location.href;\n    name = name.replace(/[\\[\\]]/g, \"\\\\$&\");\n    var regex = new RegExp(\"[?&]\" + name + \"(=([^&#]*)|&|#|$)\"),\n        results = regex.exec(url);\n    if (!results) return null;\n    if (!results[2]) return '';\n    return decodeURIComponent(results[2].replace(/\\+/g, \" \"));\n}"]}